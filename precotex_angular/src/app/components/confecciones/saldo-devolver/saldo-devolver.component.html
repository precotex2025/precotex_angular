<div class="container">
    <!-- ventana nro 4 - historial -->
    <div class="grid-container">

        <div class="title" style="color:white;">REPORTE SALDOS POR DEVOLVER CORTE</div>

        <form class="container-cuerpo" [formGroup]="formulario">
            <div class="container-cuerpo-fila21"> 

  

                <mat-form-field class="fila21-dni" appearance="fill">
                    <mat-label>Rango de Fecha</mat-label>
                    <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                      <input
                        matStartDate
                        formControlName="start"
                        placeholder="Fecha Inicio"
                      />
                      <input matEndDate formControlName="end" placeholder="Fecha Final" />
                    </mat-date-range-input>
                    <mat-datepicker-toggle
                      matSuffix
                      [for]="picker"
                    ></mat-datepicker-toggle>
                    <mat-date-range-picker #picker></mat-date-range-picker>
                    
                    <mat-error
                      *ngIf="range.controls.start.hasError('matStartDateInvalid')"
                      >Fecha Invalida</mat-error
                    >
                    <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')"
                      >Fecha Invalida</mat-error
                    >
                </mat-form-field>

                <!-- <mat-form-field class="fila1-nombres" appearance="fill">
                    <mat-label>Usuario</mat-label>
                    <input matInput type="text" placeholder="Usuario" formControlName="Usuario" />

                </mat-form-field> -->

                <button type="button" class="fila21-buscar" mat-flat-button (click)="MostrarCabeceraPaquetes()"
                    >                    
                    <mat-icon aria-label="person">search</mat-icon>Buscar
                </button>
                <button type="button" class="fila21-excel" mat-flat-button (click)="generateExcel()">                    
                <mat-icon aria-label="person">insert_drive_file</mat-icon> EXPORTAR
                </button>


            </div>

            <!-- hora	tipo	num_guia	cod_proveedor	des_proveedor	cod_usuario -->
            <div class="container-cuerpo-fila2">
                <table mat-table #table [dataSource]="dataSource" class="mat-elevation-z8">
                    <ng-container matColumnDef="ESTILO_CLIENTE">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Estilo</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.ESTILO_CLIENTE}} </td>
                    </ng-container>
                    <ng-container matColumnDef="ORDEN_CORTE">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">ORDEN CORTE</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.ORDEN_CORTE}} </td>
                    </ng-container>
                    <ng-container matColumnDef="PRESENTACION">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Presentaci贸n</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.PRESENTACION}} </td>
                    </ng-container>
                    <ng-container matColumnDef="OP">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">OP</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.OP}} </td>
                    </ng-container>
                    <ng-container matColumnDef="CLIENTE">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Cliente</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.CLIENTE}} </td>
                    </ng-container>
                    <ng-container matColumnDef="COMPONENTE">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">COMPONENTE</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.COMPONENTE}} </td>
                    </ng-container>
                    <ng-container matColumnDef="FECHA_LIQUIDACION">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">F. Liquidaci贸n</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.FECHA_LIQUIDACION}} </td>
                    </ng-container>
                    <ng-container matColumnDef="PARTIDA">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Partida</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.PARTIDA}} </td>
                    </ng-container>
                    <ng-container matColumnDef="GRUPO_TEXTIL">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Grupo Textil</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.GRUPO_TEXTIL}} </td>
                    </ng-container>
                    <ng-container matColumnDef="TELA_CODIGO">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Tela C贸d.</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.TELA_CODIGO}} </td>
                    </ng-container>

                    <ng-container matColumnDef="NOM_TELA">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Nom. Tela</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.NOM_TELA}} </td>
                    </ng-container>

                    <ng-container matColumnDef="COLOR">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Color</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.COLOR}} </td>
                    </ng-container>
                    <ng-container matColumnDef="DEVOLUCION_LIQUIDACION">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Dev. Liquidaci贸n</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.DEVOLUCION_LIQUIDACION}} </td>
                    </ng-container>
                    <ng-container matColumnDef="STOCK_TELA_ATE">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Stock Tela ATE</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.STOCK_TELA_ATE}} </td>
                    </ng-container>
                    <ng-container matColumnDef="STOCK_TELA_HUACHIPA">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Stock Tela HUACHIPA</th>
                        <td mat-cell *matCellDef="let data_det;  let i = index;" [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.STOCK_TELA_HUACHIPA}} </td>
                    </ng-container>
                    <ng-container matColumnDef="STOCK_TELA_ATE_SALDOS">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Stock Tela ATE Saldos</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.STOCK_TELA_ATE_SALDOS}} </td>
                    </ng-container>
                    <ng-container matColumnDef="FEC_MOVSTK">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">F. Movstk</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> 
                                {{data_det.FEC_MOVSTK }} 
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="KGS_DEVUELTO">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Kgs. Devuelto</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.KGS_DEVUELTO}} </td>
                    </ng-container>
                    <ng-container matColumnDef="KGS_DIFERENCIA">
                        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Kgs. Diferencia</th>
                        <td mat-cell *matCellDef="let data_det; let i = index;"  [ngStyle]="{'background': i%2 == 0 ? '#FFFFFF' : '#96C2EE' }"> {{data_det.KGS_DIFERENCIA}} </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns_cab; "></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns_cab;"></tr>
                </table>
                <mat-paginator class="paginador" #paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons
                    aria-label="Select page of periodic elements">
                </mat-paginator>

            </div>
        </form>

    </div>

</div>

<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin">
    <p style="color: white; text-align: center; ">Cargando... </p>
</ngx-spinner>