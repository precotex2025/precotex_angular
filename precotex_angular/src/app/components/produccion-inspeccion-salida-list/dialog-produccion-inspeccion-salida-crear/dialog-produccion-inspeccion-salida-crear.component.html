<div class="container-dialog">
    <!-- ventana nro 4 - historial -->
    <div class="grid-container-dialog">

      <div class="title-dialog"><span class="numhoja">{{Titulo}}</span></div>
      <form class="container-cuerpo-dialog" [formGroup]="formulario">

        <div class="container-cuerpo-fila1-dialog">
            <div class="row">

                <div class="col-md-4">
                    <mat-card>
                        <mat-card-content>
                            <div class="row">
                                    <mat-form-field>
                                        <mat-label>Fecha</mat-label>
                                        <input matInput type="datetime-local" formControlName="sFechaHoraIngreso">
                                    </mat-form-field>
                            </div>
                            <div class="row">
                                <mat-form-field appearance="fill">
                                    <mat-label>Ruta de prenda</mat-label>
                                    <mat-select formControlName="sRutaPrenda">
                                        <mat-option *ngFor="let option of lstOptTipoPrenda" [value]="option.id">
                                            {{option.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <mat-form-field appearance="fill">
                                        <mat-label>Supervisor</mat-label>
                                        <input matInput type="text" #trigger="matAutocompleteTrigger" placeholder="Supervisor" formControlName="sSupervisor" [matAutocomplete]="autoDataSupervisor" />
                                        <mat-autocomplete autoActiveFirstOption #autoDataSupervisor="matAutocomplete">
                                            <mat-option *ngFor="let option of filtroOperacionSupervisor | async" [value]="option.Nom_Auditor">
                                                {{option.Nom_Auditor}}
                                            </mat-option> 
                                        </mat-autocomplete>                            
                                    </mat-form-field>
                                </div>
                            </div>
                            

                                                 
                            
                        </mat-card-content>
                    </mat-card>
                </div>

                <div class="col-md-8">
                    <mat-card>
                        <mat-card-content>
                            
                            <div class="row">
                                <div class="caja-cliente">
                                    <mat-form-field>
                                        <mat-label>OP*</mat-label>
                                        <input matInput type="text" placeholder="OP" formControlName="sOP"
                                            maxlength="5" autocomplete="off" (input)="buscarClienteEstiloTemxOP()">
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="caja-cliente">
                                    <mat-form-field> 
                                        <mat-label>Cliente</mat-label>
                                        <input matInput type="text"  placeholder="Cliente" value="" autocomplete="off" formControlName="sCliente">
                                    </mat-form-field>
                                </div>
                                <div class="caja-cliente">
                                    <mat-form-field> 
                                        <mat-label>Estilo</mat-label>
                                        <input matInput type="text" placeholder="Estilo" value="" autocomplete="off" formControlName="sEstilo">
                                    </mat-form-field>
                                </div>
                                
                            </div>
                            <div class="row">
                                <div class="caja-cliente">
                                    <mat-form-field appearance="fill">
                                        <mat-label>Temporada</mat-label>
                                        <mat-select formControlName="sTemporada">
                                            <mat-option *ngFor="let option of lstOperacionTemporada" [value]="option.Codigo" (click)="selTemporada(option)">
                                                {{option.Descripcion}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="caja-cliente">
                                    <mat-form-field appearance="fill">
                                        <mat-label>Color</mat-label>
                                        <mat-select formControlName="sColor">
                                            <mat-option *ngFor="let option of lstOperacionColor" [value]="option.Cod_Present" (click)="selColor(option)">
                                                {{option.Des_Present}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>

                            <div class="row">
                                <div class="caja-cliente">
                                    <mat-form-field>
                                        <mat-label>Lote</mat-label>
                                        <input matInput type="number" placeholder="" value="" autocomplete="off" formControlName="sLote">
                                    </mat-form-field>
                                </div>
                                <div class="caja-cliente">
                                    <mat-form-field>
                                        <mat-label>Muestra</mat-label>
                                        <input matInput type="number" placeholder="" value="" autocomplete="off" formControlName="sMuestra">
                                    </mat-form-field>
                                </div>
                            </div>
                            
                            
                        </mat-card-content>
                    </mat-card>
                </div>

            </div>
        </div>

        <div class="container-cuerpo-fila2" *ngIf="grdPanelVisible">
            <div class="row">
                <div class="col-md-12">
                    <mat-card>
                        <mat-card-header>
                            DEFECTOS:
                        </mat-card-header>
                        <mat-card-content>
                            <div>
                                <div class="row">

                                    <div class="caja-cliente-four">
                                        <mat-form-field>
                                            <mat-label>Codigo</mat-label>
                                            <input matInput type="number" placeholder="Codigo" formControlName="sCodigo" autocomplete="off" (input)="BuscarMotivo($event)">
                                        </mat-form-field>
                                    </div>
                                    <div class="caja-cliente-four">
                                        <mat-form-field>
                                            <mat-label>Defecto</mat-label>
                                            <input matInput type="text" autocomplete="off" formControlName="sDescripcion">
                                        </mat-form-field>
                                    </div>
                                    <div class="caja-cliente-four">
                                        <mat-form-field>
                                            <mat-label>Cantidad</mat-label>
                                            <input matInput type="number" placeholder="" formControlName="sCantidad" autocomplete="off">
                                        </mat-form-field>
                                    </div>
                                    <div class="caja-cliente-four">
                                        <mat-form-field appearance="fill">
                                            <mat-label>Selecciona Tipo</mat-label>
                                            <mat-select formControlName="sTipoDefecto">
                                                <mat-option *ngFor="let option of lstTipoDefecto" [value]="option.id">
                                                    {{option.name}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="caja-cliente-four">
                                        <button type="button" (click)="addDefecto()" class="button-add-defecto" mat-flat-button>
                                            <mat-icon aria-label="person">add
                                            </mat-icon> Agregar
                                        </button>
                                    </div>
                                    
                                </div>
                            </div>

                            <div>
                                <table class="table table-striped" *ngIf="dataItemsDefectos.length > 0">
                                    <thead>
                                      <tr>
                                        <th>Codigo</th>
                                        <th>Defecto</th>
                                        <th>Cantidad</th>
                                        <th>D.Leve</th>
                                        <th>D.Critico</th>
                                        <th>Eliminar</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of dataItemsDefectos">
                                        <td>{{item.Cod_Motivo}}</td>
                                        <td>{{item.Descripcion}}</td>
                                        <td>{{item.Cantidad}}</td>
                                        <td><span *ngIf="item.Tipo == 'Leve'"><mat-icon style="color: green; font-weight: bold; font-size: 30px;">check</mat-icon></span></td>
                                        <td><span *ngIf="item.Tipo == 'Critico'"><mat-icon style="color: green; font-weight: bold; font-size: 30px;">check</mat-icon></span></td>
                                        <td><button mat-icon-button color="warn" type="button" (click)="supItemMotivo(item)"><mat-icon>delete</mat-icon></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </mat-card-content>
                    </mat-card>
                </div>
            </div>
        </div>

        <div class="container-cuerpo-fila4" *ngIf="dataItemsOps.length > 0">
            <div class="row">
                <div class="col-md-12">
                    <mat-card>
                        <mat-card-header>
                            OP por Aprobar o Rechazar:
                        </mat-card-header>
                        <mat-card-content>
                            <table class="ops">
                                <thead>
                                    <tr>
                                        <!--<th>Sel</th>-->
                                        <th>OP</th>
                                        <th>Color</th>
                                        <th>Destino</th>
                                        <th>Estado</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let item of dataItemsOps; index as i">
                                        <!--<td><mat-checkbox class="example-margin" color="primary" name="chk_estamp_{{item.cod_ordpro}}" value="ops" [checked]="item.Sel == '1'" (change)="changeCheck($event, item.cod_ordpro, 'ops')"></mat-checkbox></td>-->
                                        <td>{{item.cod_ordpro}}</td>
                                        <td>{{item.Des_Present}}</td>
                                        <td>{{item.Des_Destino}}</td>
                                        <td class="estados">
                                            <mat-radio-group aria-labelledby="example-radio-group-label">
                                                <mat-radio-button class="example-radio-button-interno" *ngFor="let option of optResultado"
                                                    [value]="option.id" 
                                                    [name]="'chk_estado_' +  item.cod_ordpro" 
                                                    [checked]="item.Flg_Estado === option.id"
                                                    (change)="changeRadio($event, item)">
                                                    {{option.name}}
                                                </mat-radio-button>
                                            </mat-radio-group>
                                        </td>
                                    </tr>
                                </tbody>
                                </table>
                        </mat-card-content>
                    </mat-card>
                </div>
            </div>
        </div>

        <div class="container-cuerpo-fila5">
            <div class="row">
                <div class="col-md-2">
                    <h4><b>Observacion:</b></h4>
                </div>
                <div class="col-md-10">
                    <mat-form-field>
                        <mat-label>Observacion:</mat-label>
                        <textarea matInput type="text" placeholder="Observaciones" value="" autocomplete="off" formControlName="sObservacion"></textarea>
                    </mat-form-field>
                </div>
            </div>
        </div>

        <div class="container-cuerpo-foot-dialog">
            <!--<button type="button" class="button-clean-dialog" mat-flat-button>
              <mat-icon aria-label="person">autorenew</mat-icon>
              Limpiar
            </button>-->
            <button type="button" class="button-save-dialog" mat-flat-button  *ngIf="btnAccionModificar" (click)="ModificarHoja()">
                <mat-icon aria-label="person">save</mat-icon>
                Actualizar
            </button>
    
    
            <button type="button" class="button-save-dialog" mat-flat-button  *ngIf="!btnAccionModificar" (click)="RegistrarHoja()">
              <mat-icon aria-label="person">save</mat-icon>
              Guardar
            </button>
    
    
            <button mat-dialog-close type="button" class="button-cancel-dialog" mat-button mat-dialog-close
              mat-dialog-close="false">
              <mat-icon aria-label="person">cancel
              </mat-icon> Cancelar
            </button>
        </div>
          
       </form>

    </div>
</div>
<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin">
  <p style="color: white; text-align: center; ">Cargando... </p>
</ngx-spinner>